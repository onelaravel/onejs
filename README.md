# @onelaravel/onejs

The Core JavaScript Framework for OneLaravel applications. This library provides the fundamental runtime, view management, and routing capabilities for building OneLaravel SPAs.

## Installation

```bash
npm install @onelaravel/onejs
```

## Usage

OneJS is designed to be the "engine" while your application provides the "map" (Views and Configuration).

### 1. Project Structure

Ensure your project has the following recommended structure for frontend assets:
```
resources/js/
├── app.js                        # Main entry point
├── config/
│   └── viewRegistry.generated.js # (Generated by build tools)
└── views/                        # Your specific application views
```

### 2. Main Entry (`app.js`)

In your project's main JavaScript entry point, you need to wire up the Core with your Project's views:

```javascript
import { App, viewLoader } from '@onelaravel/onejs';
import { viewRegistry } from './config/viewRegistry.generated.js';

// 1. Dependency Injection: Tell the Core where to find your views
viewLoader.setRegistry(viewRegistry);

// 2. Initialize the App
// The App will look for window.APP_CONFIGS (injected by Laravel Blade) to configure itself
if (window.APP_CONFIGS) {
    App.init();
}

// 3. Export for UMD/Debugging (Optional)
window.App = App;
```

### 3. Server-Side Setup (Blade)

Ensure your main layout file injects the configuration:

```html
<script>
    window.APP_CONFIGS = {
        env: { ... },
        routes: [ ... ],
        // ... other configurations
    };
</script>
<script src="{{ mix('js/app.js') }}"></script>
```

## Core Concepts

### ViewLoader vs ViewRegistry

- **ViewLoader** (Library): The logic responsible for dynamically importing and caching views. It is "blind" until it receives a registry.
- **ViewRegistry** (Project): A map of view names (e.g., `'auth.login'`) to dynamic import functions. This is typically auto-generated by your build tools.

### Event Service

OneJS comes with a built-in Event Service for cross-component communication:

```javascript
import { App } from '@onelaravel/onejs';

// Listen
App.Event.on('user:logged-in', (user) => {
    console.log(user);
});

// Emit
App.Event.emit('user:logged-in', { id: 1, name: 'John' });
```

## License

MIT
